<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Connect AI English App</title>
    <link rel="icon" href="assets/logo.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="assets/logo.svg">
    <meta name="theme-color" content="#0071e3">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- Dynamic Bubble Welcome Screen -->
    <div id="welcome-bubbles">
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
        <div class="bubble"></div>
    </div>

    <!-- Full-screen Welcome Overlay (shown before entering the app) -->
    <div id="welcome-screen">
        <div class="welcome-card">
            <img src="assets/logo.svg" alt="leaEng logo" class="welcome-logo" />
            <h2>Welcome to leaEng</h2>
            <p>Your personalized AI English learning companion.</p>
            <button id="enter-app-button" class="primary-button">Enter App â€” created by @thesonehub</button>
        </div>
    </div>

    <!-- Persistent Header -->
    <header>
        <div class="logo-and-controls">
            <img src="assets/logo.svg" alt="Global Connect logo" class="app-logo" />
            <button id="lofi-play-btn" class="lofi-btn" title="Play/Pause lofi beats">ğŸ§</button>
        </div>
        <h1 id="page-title">Welcome</h1>
        <nav>
            <button class="nav-button" data-page="main-dashboard">ğŸ  Home</button>
            <button class="nav-button" data-page="my-notes">ğŸ§¾ My Notes</button>
            <button class="nav-button" data-page="check-level">ğŸ” Check My Level</button>
            <button class="nav-button" data-page="settings">âš™ï¸ Settings</button>
        </nav>
    </header>

    <!-- Hidden container for lofi YT player -->
    <div id="lofi-player"></div>

    <!-- Main App Content Area -->
    <main id="app-content">

        <!-- Page 1: Level Assessment -->
        <div id="level-assessment" class="page-container">
            <button class="page-back-btn secondary-button" aria-label="Back">â† Back</button>
            <h1>Welcome to Your AI English Coach</h1>
            <p>To personalize your learning journey, let's find your English level with a quick writing task.</p>
            <hr>
            <h3>Freedom Essay âœï¸</h3>
            <p>Please write a few sentences about your favorite hobby or your last holiday.</p>
            <textarea id="writing-input" rows="6" placeholder="Start writing here..."></textarea>
            <button id="analyze-button">Analyze My Level & Begin</button>
            <div id="result-display"></div>
        </div>

        <!-- Page X: Check My Level (progress) -->
        <div id="check-level" class="page-container" style="display: none;">
            <button class="page-back-btn secondary-button" aria-label="Back">â† Back</button>
            <h1>Check My Level ğŸ”</h1>
            <p>Write a short essay (about 50-150 words). The AI will estimate your CEFR level and save this check as part of your progress history.</p>
            <textarea id="check-level-input" rows="6" placeholder="Write your essay here..."></textarea>
            <div style="margin-top:12px; display:flex; gap:10px; align-items:center;">
                <button id="check-level-button">Check My Level</button>
                <button id="clear-level-history-button" class="secondary-button">Clear History</button>
                <span id="check-level-status" style="font-style:italic;color:green;opacity:0;transition: opacity 0.2s;">Saved</span>
            </div>
            <div id="checklevel-result" class="feedback-box" style="margin-top:16px;">Your level result will appear here.</div>

            <hr style="margin:20px 0;">
            <h2>Your Level Progress ğŸ“ˆ</h2>
            <div id="level-progress-list">No checks recorded yet.</div>
        </div>

        <!-- Page 2: Main Dashboard -->
        <div id="main-dashboard" class="page-container" style="display: none;">
            <h1 id="welcome-message">Welcome!</h1>
            <p>What would you like to practice today?</p>
            <div class="feature-grid">
                <div id="reading-card" class="card">ğŸ“– Reading</div>
                <div id="writing-card" class="card">âœï¸ Writing</div>
                <div id="speaking-card" class="card">ğŸ™ï¸ Speaking</div>
                <div id="listening-card" class="card">ğŸ§ Listening</div>
            </div>
        </div>

        <!-- Page 3: Reading Section -->
        <div id="reading-section" class="page-container" style="display: none;">
            <button class="page-back-btn secondary-button" aria-label="Back">â† Back</button>
            <h1>Reading Exploration ğŸ”</h1>
            <div class="topic-controls">
                <input type="text" id="topic-input" placeholder="Enter a topic (e.g., 'Artificial Intelligence', 'Philosophy')">
                <button id="generate-passages-button">Generate Passages</button>
            </div>
            <div id="passages-wrapper" class="passages-container">
                <p>Enter a topic above to generate three reading passages at different CEFR levels.</p>
            </div>
        </div>

        <!-- Page 4: Writing Section -->
        <div id="writing-section" class="page-container" style="display: none;">
            <button class="page-back-btn secondary-button" aria-label="Back">â† Back</button>
            <h1>Practice Your Writing ğŸª¶</h1>
            <p>Write a summary about a story you read, or simply write about your day.</p>
            <textarea id="writing-practice-input" rows="8" placeholder="Start writing here..."></textarea>
            <button id="check-writing-button">Check My Writing ğŸ§ </button>
            <div id="writing-feedback" class="feedback-box">
                Your feedback will appear here.
            </div>
        </div>
        
        <!-- Page 5: Speaking Section -->
        <div id="speaking-section" class="page-container" style="display: none;">
            <button class="page-back-btn secondary-button" aria-label="Back">â† Back</button>
            <h1>Speaking Practice ğŸ™ï¸</h1>
            <div class="mode-selector">
                <button id="freestyle-mode-btn" class="mode-btn active">Freestyle ğŸ’¬</button>
                <button id="guided-mode-btn" class="mode-btn">Guided Practice ğŸ“–</button>
            </div>
            <div id="guided-practice-area" style="display: none;">
                <div class="guided-sentence-box">
                    <p id="sentence-to-read">Click "Get New Sentence" to start.</p>
                </div>
                <button id="get-sentence-btn">Get New Sentence ğŸª„</button>
            </div>
            <div class="speaking-controls">
                <button id="record-button">Start Recording</button>
                <button id="stop-button" disabled>Stop Recording</button>
            </div>
            <h2>Your Recordings ğŸ§¾</h2>
            <div id="recording-list"></div>
        </div>

        <!-- Page 6: Listening Section -->
        <div id="listening-section" class="page-container" style="display: none;">
            <button class="page-back-btn secondary-button" aria-label="Back">â† Back</button>
            <div id="video-selection-area">
                <h1>Listening Practice ğŸ§</h1>
                <p>Your favorite channels. Click a video to start.</p>
                <div id="video-list" class="video-grid"></div>
            </div>
            <div id="player-and-notes-area" style="display: none;">
                <div id="player-container"><div id="player"></div></div>
                <div class="note-area">
                    <textarea id="video-notes" placeholder="Take notes here..."></textarea>
                    <div class="note-actions">
                        <button id="save-note-button">Save Note</button>
                        <span id="save-status"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Page 7: My Notes -->
        <div id="my-notes" class="page-container" style="display: none;">
            <button class="page-back-btn secondary-button" aria-label="Back">â† Back</button>
            <div class="page-header">
                <h1>My Notes ğŸ“‘</h1>
                <button id="export-notes-button">Export as Markdown</button>
            </div>
            <div id="notes-list" class="notes-container">Your saved notes will appear here.</div>
        </div>
        
        <!-- Page 8: Settings -->
        <div id="settings" class="page-container" style="display: none;">
            <button id="settings-back-button" class="secondary-button page-back-btn" aria-label="Back to previous page">â† Back</button>
            <h1>Settings âš™ï¸</h1>
            <div class="setting-item">
                <span>Theme ğŸ’«/ğŸŒ™</span>
                <button id="theme-toggle-button">Toggle Dark/Light Mode</button>
            </div>
            <hr>
            <h2>API Keys ğŸ”‘</h2>
            <div class="api-key-manager">
                <label for="api-key-input">Your Google AI Studio API Key:</label>
                <input type="password" id="api-key-input" placeholder="Enter your key here">
                <button id="save-api-key-button">Save Key</button>
                <small>Your key is saved securely in your browser only.</small>
            </div>
            <hr>
            <h2>Manage YouTube Channels ğŸ§ (Max 5)</h2>
            <div id="channel-manager" class="channel-manager">
                <input type="text" id="channel-input" placeholder="Paste YouTube Channel ID">
                <button id="add-channel-button">Add Channel</button>
            </div>
            <div id="channel-list"></div>
            <hr>
            <div class="setting-item danger-zone">
                <span>Danger Zone âš¡</span>
                <button id="reset-app-button" class="danger-button">Reset App Data</button>
            </div>
        </div>

    </main>
    
    <!-- Floating/Modal Elements -->
    <div id="dictionary-popup" style="display: none;"></div>
    
    <div id="reassessment-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>ğŸ“… Weekly Level Check-in!</h2>
            <p>Let's see how much you've improved. This helps us adjust your content for the week ahead.</p>
            <div id="reassessment-mcq-area">
                <p>Generating questions...</p>
            </div>
            <hr>
            <h3>Freedom Essay âœï¸</h3>
            <p>Write a few sentences about what you learned this week.</p>
            <textarea id="reassessment-essay" rows="5"></textarea>
            <button id="submit-reassessment-btn">Submit & Update My Level</button>
        </div>
    </div>

    <!-- Script Tags (Must be at the end of the body) -->
    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="script.js"></script>

</body>
</html>